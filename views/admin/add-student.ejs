<%- include('partials/header.ejs') %>
<style>
  /* #output {
  padding: 20px;
  background: #dadada;
} */

  form {
    margin-top: 20px;
  }

  select {
    width: 300px;
  }
</style>
<div class="main-content">
  <section class="section">
    <div class="section-body">
      <div class="row">
        <div class="col-12">
          <div class="card">
            <div class="card-headers row">
              <div class="col-12">
                <div class="university-card-header">
                  <h4>Add Students</h4>
                </div>
              </div>
            </div>
            <div class="card-body">
              <form id="addform">
                <div class="row">
                  <div class="form-group w-50">
                    <label>Name</label>
                    <input
                      type="text"
                      class="form-control"
                      name="name"
                      placeholder="Enter Name"
                    />
                  </div>
                  <div class="form-group w-50">
                    <label>Email</label>
                    <input
                      type="text"
                      class="form-control"
                      name="email"
                      placeholder="Enter Email"
                    />
                  </div>
                </div>

                <div class="row">
                  <div class="form-group w-50">
                    <label>Mobile Number</label>
                    <input
                      type="text"
                      class="form-control"
                      id="mobile_number"
                      name="mobile_number"
                      placeholder="Enter Mobile Number"
                    />
                  </div>
                  <div class="form-group w-50">
                    <div id="output"></div>
                    <h6>Course</h6>
                    <div class="form-group add-university-form">
                      <select
                        data-placeholder="Choose course..."
                        name="course"
                        multiple
                        class="chosen-select"
                      >
                        <% course.forEach(function(course){%>
                        <option value="<%= course._id %>">
                          <%= course.course_name %>
                        </option>
                        <% }); %>
                      </select>
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="form-group w-50">
                    <label>College</label>
                    <select
                      class="form-control show-tick ms select2"
                      data-placeholder="Select"
                      name="college_name"
                    >
                      <option value="" disabled selected>Select College</option>
                      <% college_name.forEach(function(college_name){%>
                      <option value="<%= college_name._id %>">
                        <%= college_name.name %>
                      </option>
                      <% }); %>
                    </select>
                  </div>
                  <div class="form-group w-50">
                    <label>Year</label>
                    <input
                      type="number"
                      class="form-control"
                      name="year"
                      placeholder="Enter year"
                    />
                  </div>
                </div>

                <div class="row">
                  <div class="form-group w-50 col-6">
                    <label>Gender</label>
                    <select
                      name="gender"
                      class="form-control show-tick ms select2"
                      data-placeholder="Select"
                    >
                      <option value="">Select</option>
                      <option value="Male">Male</option>
                      <option value="Female">Female</option>
                    </select>
                  </div>
                  <div class="form-group w-50 col-6">
                    <label>Date Of Birth</label>
                    <input
                      type="date"
                      class="form-control"
                      name="dob"
                      placeholder="Enter DOB"
                    />
                  </div>
                </div>
                <div class="row">
                  <div class="col-6">
                    <div class="form-group">
                      <label for="image" class="form-label">Address</label>
                      <div class="custom-file">
                        <input
                          type="text"
                          class="form-control"
                          id="address"
                          name="address"
                          placeholder="Enter Address"
                        />
                      </div>
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="form-group">
                      <label>State</label>
                      <select id="state" name="state" class="form-control">
                        <option value="">Select State</option>
                        <option value="Andaman and Nicobar Islands">
                          Andaman and Nicobar Islands
                        </option>
                        <option value="Andhra Pradesh">Andhra Pradesh</option>
                        <option value="Arunachal Pradesh">
                          Arunachal Pradesh
                        </option>
                        <option value="Assam">Assam</option>
                        <option value="Bihar">Bihar</option>
                        <option value="Chandigarh">Chandigarh</option>
                        <option value="Chhattisgarh">Chhattisgarh</option>
                        <option value="Dadra and Nagar Haveli">
                          Dadra and Nagar Haveli
                        </option>
                        <option value="Daman and Diu">Daman and Diu</option>
                        <option value="Delhi">Delhi</option>
                        <option value="Goa">Goa</option>
                        <option value="Gujarat">Gujarat</option>
                        <option value="Haryana">Haryana</option>
                        <option value="Himachal Pradesh">
                          Himachal Pradesh
                        </option>
                        <option value="Jammu and Kashmir">
                          Jammu and Kashmir
                        </option>
                        <option value="Jharkhand">Jharkhand</option>
                        <option value="Karnataka">Karnataka</option>
                        <option value="Kerala">Kerala</option>
                        <option value="Lakshadweep">Lakshadweep</option>
                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                        <option value="Maharashtra">Maharashtra</option>
                        <option value="Manipur">Manipur</option>
                        <option value="Meghalaya">Meghalaya</option>
                        <option value="Mizoram">Mizoram</option>
                        <option value="Nagaland">Nagaland</option>
                        <option value="Orissa">Orissa</option>
                        <option value="Pondicherry">Pondicherry</option>
                        <option value="Punjab">Punjab</option>
                        <option value="Rajasthan">Rajasthan</option>
                        <option value="Sikkim">Sikkim</option>
                        <option value="Tamil Nadu">Tamil Nadu</option>
                        <option value="Tripura">Tripura</option>
                        <option value="Uttaranchal">Uttaranchal</option>
                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                        <option value="West Bengal">West Bengal</option>
                      </select>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-6">
                    <div class="form-group">
                      <label>Pincode</label>
                      <input
                        type="text"
                        name="pincode"
                        id="pincode"
                        class="form-control"
                        placeholder="Enter Pincode"
                      />
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="form-group">
                      <label for="image" class="form-label">Image</label>
                      <div class="custom-file">
                        <input
                          type="file"
                          class="form-control"
                          id="image"
                          name="image"
                        />
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row text-right">
                  <div class="col-12">
                    <button class="btn btn-primary">Add</button>
                  </div>
                </div>
              </form>
            </div>
          </div>
          <!--  -->
        </div>
      </div>
    </div>
  </section>
</div>
<%- include('partials/footer.ejs') %>

<!-- multipart select -->
<script>
  document.getElementById("output").innerHTML = location.search;
  $(".chosen-select").chosen();
</script>

<script>
  var addform = $("#addform");

  addform.on("submit", addslidersubmitHandler);

  function addslidersubmitHandler(e) {
    e.preventDefault();

    if ($("#mobile_number").val() == "") {
      alert("mobile_number is required");
      return false;
    } else if ($("#mobile_number").val().length > 10) {
      alert("mobile_number max length is 10 charactor");
      return false;
    } else if ($("#mobile_number").val().length < 10) {
      alert("mobile_number max length is 10 charactor");
      return false;
    }

    if ($("#pincode").val() == "") {
      alert("pincode is required");
      return false;
    } else if ($("#pincode").val().length > 6) {
      alert("pincode max length is 6 charactor");
      return false;
    } else if ($("#pincode").val().length < 6) {
      alert("pincode max length is 6 charactor");
      return false;
    }

    // PREPARE FORM DATA
    var formData = new FormData(addform[0]);
    console.log(formData);

    // // DO POST
    $.ajax({
      type: "POST",
      enctype: "multipart/form-data",
      cache: false,
      processData: false,
      contentType: false,
      url: "/admin/user/student/add",
      data: formData,
    })
      .done((res) => {
        if (res.error == true) {
          renderToast({ message: res.message, icon: "error" });
        } else {
          renderToast({ message: res.message, icon: "success" });
          setTimeout(() => {
            window.location.replace("/admin/user/list");
          }, 1000);
        }
      })
      .fail(function (xhr, status, error) {
        console.log(xhr.responseText);
      });
  }
</script>
